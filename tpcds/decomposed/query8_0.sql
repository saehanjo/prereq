create table subquery584591 as SELECT SUBSTR(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10;

create table subquery420219 as SELECT ca_zip FROM (select * from subquery584591) AS A1;

create table subquery459404 as SELECT SUBSTR(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTR(ca_zip, 1, 5) IN ('41967', '48333', '50788', '17879', '75660', '55349', '24660', '14440', '43933', '18410', '24286', '24227', '68341', '83833', '24594', '53565', '42361', '58581', '11340', '43432', '41255', '58062', '62361', '17291', '68770', '19444', '80332', '75752', '48017', '60736', '57631', '41232', '70041', '45645', '49472', '59004', '10374', '17819', '98584', '24891', '14312', '45484', '12350', '23065', '22911', '81070', '93498', '28055', '88137', '81755', '81963', '54558', '51933', '67975', '79658', '52868', '78093', '17167', '14196', '89338', '81084', '13443', '86379', '43639', '86057', '46507', '98072', '35926', '72592', '83583', '83041', '65501', '83647', '52094', '25973', '18569', '38607', '41331', '28239', '25333', '33773', '81335', '58032', '59345', '66943', '16515', '34306', '90669', '26689', '47602', '32489', '18360', '20534', '83910', '58454', '27385', '45676', '49254', '29392', '25178', '12197', '56355', '96435', '21231', '51766', '16226', '57553', '41351', '51717', '32669', '92292', '25115', '33869', '73219', '21094', '68101', '53163', '45266', '49211', '20244', '36335', '14530', '16704', '94835', '88086', '22815', '16891', '95464', '83986', '73146', '47529', '56436', '29818', '14073', '50679', '56877', '39459', '21204', '60083', '17895', '56224', '25214', '49101', '24255', '59080', '10298', '13376', '61527', '25494', '52389', '18434', '50636', '27700', '55233', '47289', '69280', '58058', '79077', '16791', '18829', '17672', '92380', '84844', '18884', '45533', '98069', '11912', '62585', '49140', '54010', '63991', '30621', '39503', '97173', '35390', '78366', '89193', '46081', '34948', '58412', '18421', '16005', '14155', '41162', '61794', '60624', '12318', '95430', '50412', '27116', '39214', '33159', '11686', '47369', '16364', '33562', '70073', '63073', '68852', '73108', '23952', '71997', '74686', '17193', '69952', '27156', '71144', '81504', '84247', '40979', '65148', '11855', '64592', '60560', '34972', '46131', '57025', '35834', '57649', '31013', '26217', '51195', '11489', '12320', '63180', '70450', '84919', '94791', '69998', '36479', '82080', '41419', '41836', '86709', '48162', '13378', '68293', '29450', '98862', '61860', '99060', '59130', '51782', '68843', '92696', '18218', '31830', '91110', '13123', '11618', '21343', '36430', '83086', '85761', '33113', '13869', '82620', '71256', '56600', '98533', '63193', '34594', '39500', '21814', '95042', '38353', '59386', '53535', '63792', '20712', '71286', '49230', '36201', '18700', '27369', '13918', '63294', '54207', '14851', '27413', '14242', '18767', '19326', '90229', '73873', '88217', '98338', '37119', '71836', '80846', '13261', '65177', '71948', '58218', '75742', '77454', '52301', '75675', '43830', '41807', '29752', '32754', '35863', '73134', '98569', '15475', '19988', '10425', '96560', '21060', '13844', '90209', '66057', '67881', '22728', '70070', '11652', '29086', '18367');

create table subquery158870 as SELECT ca_zip FROM (select * from subquery459404 INTERSECT select * from subquery420219) AS A2;

create table subquery392063 as SELECT s_store_name, SUM(ss_net_profit) FROM store_sales, date_dim, store, (select * from subquery158870) AS V1 WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d_date_sk AND d_qoy = 2 AND d_year = 1998 AND (SUBSTR(s_zip, 1, 2) = SUBSTR(V1.ca_zip, 1, 2)) GROUP BY s_store_name ORDER BY s_store_name;

SELECT * FROM (select * from subquery392063) WHERE rownum <= 100;

