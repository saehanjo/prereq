create table subquery633293 as SELECT SUBSTR(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10;

create table subquery645341 as SELECT ca_zip FROM (select * from subquery633293) AS A1;

create table subquery115923 as SELECT SUBSTR(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTR(ca_zip, 1, 5) IN ('82586', '59699', '80112', '48589', '19098', '49880', '58811', '34600', '74332', '65630', '88117', '20904', '33783', '43513', '27997', '14383', '21501', '56043', '48382', '72747', '41331', '48009', '15659', '14696', '41816', '48961', '81254', '95204', '68194', '87921', '90918', '85366', '67845', '43447', '87554', '52290', '10948', '63455', '48323', '82575', '11712', '12984', '37548', '30590', '19790', '58143', '19627', '59791', '58014', '69064', '21984', '95169', '86781', '35352', '58016', '15931', '13058', '23506', '11026', '88278', '60937', '50928', '62081', '55133', '87418', '24927', '14562', '18554', '67247', '83242', '12670', '75595', '57595', '70060', '32999', '18362', '99472', '45669', '20611', '29096', '19317', '76776', '78878', '58662', '42600', '87060', '37315', '25377', '60906', '48243', '75036', '73195', '52767', '43826', '10592', '31977', '40824', '98029', '11389', '75366', '73730', '97634', '64372', '49791', '16644', '91138', '20195', '38159', '41102', '24739', '32770', '39941', '21154', '55681', '14220', '28778', '61969', '83449', '89898', '40980', '77845', '79784', '89746', '74886', '76771', '39830', '66036', '74646', '67440', '65160', '32324', '18781', '25536', '13976', '50400', '23899', '41633', '24527', '52104', '16127', '28739', '69410', '49867', '13170', '59252', '36204', '31181', '22408', '90809', '78225', '40958', '73927', '25351', '98235', '89880', '66221', '53515', '74188', '83537', '78906', '37879', '32843', '65738', '14288', '27443', '63041', '23178', '39939', '12762', '13853', '92227', '76103', '63811', '34201', '74864', '73594', '13304', '50027', '65240', '59180', '15104', '35614', '25441', '91567', '14279', '11193', '15590', '71742', '82702', '16446', '18423', '88966', '45320', '12500', '30397', '12975', '67748', '19594', '62821', '19815', '26738', '99040', '16282', '59569', '99930', '93809', '53951', '37254', '65130', '85160', '11130', '66305', '64126', '74153', '53622', '49342', '18821', '81749', '20095', '81725', '19352', '42561', '77827', '76012', '45814', '71239', '20261', '39915', '38210', '21817', '43271', '36624', '27987', '60557', '15113', '24439', '83041', '95224', '59506', '96311', '73974', '55696', '10899', '51526', '40961', '49893', '27992', '91231', '22944', '27477', '63230', '20001', '78125', '29902', '11394', '13946', '55570', '86645', '50330', '65659', '97036', '11029', '78327', '41394', '29887');

create table subquery930424 as SELECT ca_zip FROM (select * from subquery115923 INTERSECT select * from subquery645341) AS A2;

create table subquery707663 as SELECT s_store_name, SUM(ss_net_profit) FROM store_sales, date_dim, store, (select * from subquery930424) AS V1 WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d_date_sk AND d_qoy = 2 AND d_year = 1998 AND (SUBSTR(s_zip, 1, 2) = SUBSTR(V1.ca_zip, 1, 2)) GROUP BY s_store_name ORDER BY s_store_name;

SELECT * FROM (select * from subquery707663) WHERE rownum <= 100;

